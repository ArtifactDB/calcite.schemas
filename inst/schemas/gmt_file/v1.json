{
    "$id": "gmt_file/v1.json",
    "$schema": "http://json-schema.org/draft-07/schema",
    "additionalProperties": false,
    "allOf": [
        {
            "if": {
                "not": {
                    "properties": {
                        "is_child": {
                            "const": true
                        }
                    }
                }
            },
            "then": {
                "required": [
                    "title",
                    "description",
                    "maintainers",
                    "species",
                    "genome",
                    "origin",
                    "bioc_version"
                ]
            }
        }
    ],
    "description": "A file in the gene matrix transposed (GMT) format, containing feature set information. Each line corresponds to one feature set and is tab delimited. The first column contains the name of the set, the second column contains a description for the set, and the remaining columns contain the identifiers for the features in that set. If `fields` is specified, the feature columns should instead contain multiple comma-separated fields, e.g., to handle per-gene weights inside each set.",
    "properties": {
        "$schema": {
            "description": "The schema to use.",
            "type": "string"
        },
        "bioc_version": {
            "description": "Version of Bioconductor used to generate this resource.",
            "pattern": "^[0-9]+\\.[0-9]+$",
            "type": "string"
        },
        "description": {
            "description": "Description of the resource.",
            "type": "string"
        },
        "genome": {
            "description": "UCSC, Ensembl or other genome builds involved in generating this resource.",
            "items": {
                "properties": {
                    "id": {
                        "description": "Identifier for this genome build.",
                        "examples": [
                            "mm10",
                            "NCBIm37"
                        ],
                        "type": "string"
                    },
                    "source": {
                        "description": "Source of the genome build identifier.",
                        "enum": [
                            "Ensembl",
                            "UCSC",
                            "Wormbase",
                            "Flybase"
                        ],
                        "type": "string"
                    }
                },
                "required": [
                    "id",
                    "source"
                ],
                "type": "object"
            },
            "type": "array"
        },
        "gmt_file": {
            "additionalProperties": false,
            "properties": {
                "compression": {
                    "description": "The compression format.",
                    "enum": [
                        "none",
                        "gzip",
                        "bzip2",
                        "bgzip"
                    ],
                    "type": "string"
                },
                "fields": {
                    "description": "Fields contained within the feature columns. Specifically, if this property is present, each feature column should contain a comma-separated array of fields instead of just a single feature identifier, e.g., `\"ENSG00000000003\",0.992,-1`. The number and type of fields in each column must be the same across all genes and all sets, and should correspond to the names and types specified in this `fields` array. The first field is always intepreted as the feature identifier. Strings should be double-quoted, unless they are missing, in which they may be `NA`. If the `fields` array is absent, we assume that there are no fields and that each feature column contains only the feature identifier.",
                    "items": {
                        "additionalProperties": false,
                        "properties": {
                            "name": {
                                "description": "Name of the field. This should be unique.",
                                "type": "string"
                            },
                            "type": {
                                "description": "Type of the field.",
                                "enum": [
                                    "integer",
                                    "number",
                                    "string",
                                    "boolean"
                                ],
                                "type": "string"
                            }
                        },
                        "required": [
                            "name",
                            "type"
                        ],
                        "type": "object"
                    },
                    "minItems": 1,
                    "type": "array"
                }
            },
            "type": "object"
        },
        "is_child": {
            "default": false,
            "description": "Is this a child document, only to be interpreted in the context of the parent document from which it is linked? This may have implications for search and metadata requirements.",
            "type": "boolean"
        },
        "maintainers": {
            "description": "Maintainers of this resource.",
            "items": {
                "properties": {
                    "email": {
                        "description": "Email of the maintainer.",
                        "pattern": "^[^@]+@[^@]+$",
                        "type": "string"
                    },
                    "name": {
                        "description": "Name of the maintainer.",
                        "type": "string"
                    }
                },
                "type": "object"
            },
            "type": "array"
        },
        "md5sum": {
            "description": "MD5 checksum for the file.",
            "type": "string"
        },
        "origin": {
            "description": "Origins of this resource.",
            "items": {
                "allOf": [
                    {
                        "if": {
                            "properties": {
                                "source": {
                                    "const": "PubMed"
                                }
                            }
                        },
                        "then": {
                            "properties": {
                                "id": {
                                    "pattern": "^[0-9]+$",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    {
                        "if": {
                            "properties": {
                                "source": {
                                    "const": "GEO"
                                }
                            }
                        },
                        "then": {
                            "properties": {
                                "id": {
                                    "pattern": "^GSE[0-9]+$",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    {
                        "if": {
                            "properties": {
                                "source": {
                                    "const": "ArrayExpress"
                                }
                            }
                        },
                        "then": {
                            "properties": {
                                "id": {
                                    "pattern": "^E-MTAB-[0-9]+$",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    {
                        "if": {
                            "properties": {
                                "source": {
                                    "const": "DOI"
                                }
                            }
                        },
                        "then": {
                            "properties": {
                                "id": {
                                    "pattern": "^[0-9a-zA-Z\\._-]+/[0-9a-zA-Z\\._-]+$",
                                    "type": "string"
                                }
                            }
                        }
                    },
                    {
                        "if": {
                            "properties": {
                                "source": {
                                    "const": "URI"
                                }
                            }
                        },
                        "then": {
                            "properties": {
                                "id": {
                                    "pattern": "^(http|ftp|https|s3|sftp)://",
                                    "type": "string"
                                }
                            }
                        }
                    }
                ],
                "properties": {
                    "id": {
                        "description": "Identifier for the resource in the specified `type`.",
                        "type": "string"
                    },
                    "source": {
                        "description": "Source database or repository.",
                        "enum": [
                            "PubMed",
                            "GEO",
                            "ArrayExpress",
                            "DOI",
                            "URI"
                        ],
                        "type": "string"
                    }
                },
                "type": "object"
            },
            "type": "array"
        },
        "path": {
            "description": "Path to the file in the project directory.",
            "type": "string"
        },
        "species": {
            "description": "NCBI taxonomy IDs of the species involved in this resource.",
            "items": {
                "minimum": 1,
                "type": "integer"
            },
            "type": "array"
        },
        "title": {
            "description": "Title of the resource.",
            "type": "string"
        }
    },
    "required": [
        "$schema",
        "gmt_file",
        "md5sum",
        "path"
    ],
    "title": "GMT file",
    "type": "object"
}
